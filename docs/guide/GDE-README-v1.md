# åŸºäºŽ Hyperledger Fabric çš„æ±½é…ä¾›åº”é“¾ååŒç³»ç»Ÿ

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäºŽ Hyperledger Fabric çš„æ±½é…ä¾›åº”é“¾ååŒç³»ç»Ÿï¼Œæ—¨åœ¨é€šè¿‡åŒºå—é“¾æŠ€æœ¯è§£å†³æ±½è½¦é›¶éƒ¨ä»¶é‡‡è´­ã€ç”Ÿäº§ä¸Žç‰©æµçŽ¯èŠ‚ä¸­çš„ä¿¡æ¯ä¸å¯¹ç§°ä¸Žå¯è¿½æº¯æ€§é—®é¢˜ã€‚

ç³»ç»Ÿé€»è¾‘ä¸Šç”±ä¸»æœºåŽ‚ã€é›¶éƒ¨ä»¶åŽ‚å•†ã€æ‰¿è¿å•†å’Œä¾›åº”é“¾å¹³å°å››ä¸ªè§’è‰²å…±åŒå‚ä¸Žï¼Œç‰©ç†ä¸Šéƒ¨ç½²äºŽä¸‰ä¸ª Fabric ç»„ç»‡ã€‚

## æœ¬åœ°å¼€å‘

å‚è€ƒï¼š[æœ¬åœ°å¼€å‘æŒ‡å—](dev.md)

æŽ¨èé¦–æ¬¡ä½¿ç”¨æ—¶é€‰æ‹©å¿«é€Ÿéƒ¨ç½²æ–¹å¼ï¼Œä»¥ä¾¿å¿«é€Ÿä½“éªŒç³»ç»ŸåŠŸèƒ½ã€‚

## å¿«é€Ÿéƒ¨ç½²

### çŽ¯å¢ƒè¦æ±‚

- Docker
- Docker Compose

### éƒ¨ç½²æ­¥éª¤

1. æ‹‰å–é¡¹ç›®ï¼ˆæˆ–æ‰‹åŠ¨ä¸‹è½½ï¼‰

   ```bash
   git clone --depth 1 https://github.com/togettoyou/fabric-realty.git
   ```

2. è®¾ç½®è„šæœ¬æƒé™

   ```bash
   cd fabric-realty
   chmod +x *.sh network/*.sh
   ```

3. ä¸€é”®éƒ¨ç½²
   > [!IMPORTANT]
   > å¦‚æžœæ‚¨æ­£åœ¨è¿›è¡ŒäºŒæ¬¡å¼€å‘å¹¶ä¿®æ”¹äº†ä»£ç ï¼Œè¯·å‚è€ƒ `redeploy_guide.md` é‡æ–°æž„å»ºé•œåƒã€‚

   ```bash
   ./install.sh
   ```

4. ä¸€é”®å¸è½½

   ```bash
   ./uninstall.sh
   ```

### è®¿é—®æœåŠ¡

http://localhost:8000

## ä¸šåŠ¡æ“ä½œæµç¨‹

ç³»ç»ŸåŒ…å«å››ä¸ªé€»è¾‘è§’è‰²ï¼Œè¦†ç›–ä»Žè®¢å•ä¸‹è¾¾åˆ°ç­¾æ”¶çš„å…¨ç”Ÿå‘½å‘¨æœŸï¼š

### 1. é‡‡è´­è®¢å•ä¸‹è¾¾ (OEM - Org1)
- ä¸»æœºåŽ‚ï¼ˆOEMï¼‰å½•å…¥é‡‡è´­éœ€æ±‚ï¼ˆé›¶ä»¶åç§°ã€æ•°é‡ã€ä»·æ ¼ç­‰ï¼‰ã€‚
- æäº¤åŽè®¢å•ä¸Šé“¾ï¼ŒçŠ¶æ€å˜ä¸º `CREATED`ã€‚

### 2. è®¢å•æŽ¥å—ä¸Žç”Ÿäº§ (Manufacturer - Org2)
- é›¶éƒ¨ä»¶åŽ‚å•†æŽ¥æ”¶åˆ°æ–°è®¢å•ï¼Œå®¡æ ¸åŽç‚¹å‡»â€œæŽ¥å—è®¢å•â€ã€‚
- çŠ¶æ€æµè½¬ï¼š`ACCEPTED` -> `PRODUCING` -> `PRODUCED`ã€‚

### 3. ç‰©æµå–è´§ä¸Žå‘è´§ (Carrier - Org3)
- æ‰¿è¿å•†ï¼ˆç‰©æµå…¬å¸ï¼‰å‰å¾€åŽ‚å•†å¤„å–è´§ã€‚
- ç¡®è®¤å–è´§åŽç”ŸæˆåŒºå—é“¾ç‰©æµå•ï¼ˆShipmentï¼‰ï¼ŒçŠ¶æ€å˜ä¸º `SHIPPED`ã€‚
- æ‰¿è¿å•†å¯å®žæ—¶æ›´æ–°ç‰©æµåœ°ç†ä½ç½®ã€‚

### 4. ç­¾æ”¶ç¡®è®¤ (OEM - Org1)
- ä¸»æœºåŽ‚æ”¶åˆ°è´§ç‰©åŽï¼Œåœ¨ç³»ç»Ÿå†…æ‰§è¡Œâ€œç¡®è®¤æ”¶è´§â€ã€‚
- è®¢å•çŠ¶æ€æœ€ç»ˆå˜ä¸º `RECEIVED`ï¼Œå®Œæˆé—­çŽ¯ã€‚

### 5. å…¨ç¨‹ç›‘ç®¡ (Platform - Org3)
- ä¾›åº”é“¾å¹³å°è§’è‰²å¯ä»¥å®žæ—¶æŸ¥çœ‹æ‰€æœ‰è®¢å•å’Œç‰©æµå•çš„å½“å‰çŠ¶æ€ä¸Žæµè½¬åŽ†å²ï¼Œç¡®ä¿æµç¨‹é€æ˜Žå¯æŽ§ã€‚

## ç³»ç»Ÿæž¶æž„

### ç½‘ç»œæž¶æž„ (Network)

é¡¹ç›®åœ¨ç‰©ç†ä¸Šç”±ä¸‰ä¸ªç»„ç»‡ï¼ˆOrg1, Org2, Org3ï¼‰æž„æˆï¼š
1. **Org1 (ä¸»æœºåŽ‚)**: ç»´æŠ¤ peer0.org1 å’Œ peer1.org1ã€‚
2. **Org2 (é›¶éƒ¨ä»¶åŽ‚)**: ç»´æŠ¤ peer0.org2 å’Œ peer1.org2ã€‚
3. **Org3 (ç‰©æµæ–¹ä¸Žå¹³å°)**: æ‰¿æ‹…æ‰¿è¿å•†ä¸Žç›‘ç®¡å¹³å°åŒé‡è§’è‰²ï¼Œç»´æŠ¤ peer0.org3 å’Œ peer1.org3ã€‚

### æ™ºèƒ½åˆçº¦ (Chaincode)

- **èµ„äº§æ¨¡åž‹**: å®šä¹‰äº† `Order`ï¼ˆè®¢å•ï¼‰å’Œ `Shipment`ï¼ˆç‰©æµå•ï¼‰ã€‚
- **æƒé™æŽ§åˆ¶**: ä¸¥æ ¼æ ¹æ®è°ƒç”¨è€…çš„ MSPID è¿›è¡Œé‰´æƒï¼ˆå¦‚ï¼šä»…é™ Org1 ç­¾æ”¶ï¼Œä»…é™ Org3 æ›´æ–°ä½ç½®ï¼‰ã€‚

### åº”ç”¨æœåŠ¡å™¨ (Application)

API è·¯ç”±æŒ‰è§’è‰²åˆ’åˆ†ï¼š
- `/api/oem`: è®¢å•åˆ›å»ºã€ç­¾æ”¶ç¡®è®¤ã€è¯¦æƒ…æŸ¥è¯¢ã€‚
- `/api/manufacturer`: æŽ¥å—è®¢å•ã€æ›´æ–°ç”Ÿäº§çŠ¶æ€ã€‚
- `/api/carrier`: ç‰©æµå–è´§ã€åœ°ç†ä½ç½®æ›´æ–°ã€‚
- `/api/platform`: è®¢å•å…¨é“¾è·¯ç›‘ç®¡æŸ¥è¯¢ã€‚

## æŠ€æœ¯æ ˆ

- **åŒºå—é“¾å±‚**: Hyperledger Fabric v2.5.10
- **åŽç«¯**: Go 1.23 + Gin v1.10.0 + Fabric Gateway SDK
- **å‰ç«¯**: Vue 3 + Vite + TypeScript + Ant Design Vue

---

## ðŸ“‚ é¡¹ç›®ç»“æž„è¯¦è§£

æœ¬é¡¹ç›®é‡‡ç”¨**åˆ†å±‚è®¾è®¡**ï¼Œä»Žåº•å±‚åŒºå—é“¾ç½‘ç»œåˆ°ä¸­é—´ä»¶æ™ºèƒ½åˆçº¦ï¼Œå†åˆ°é¢å‘ç”¨æˆ·çš„ Web åº”ç”¨ã€‚

### 1. æ ¹ç›®å½•

| æ–‡ä»¶/ç›®å½• | ç”¨é€” |
|-----------|------|
| `install.sh` | ä¸€é”®éƒ¨ç½²è„šæœ¬ï¼Œè‡ªåŠ¨åŒ–å¯åŠ¨ Fabric ç½‘ç»œä¸Žåº”ç”¨å®¹å™¨ |
| `uninstall.sh` | ä¸€é”®æ¸…ç†è„šæœ¬ |
| `dev.md` | æ ¸å¿ƒå¼€å‘æŒ‡å— |
| `README.md` | é¡¹ç›®ç®€ä»‹ã€ä¸šåŠ¡æµç¨‹åŠå¿«é€Ÿå…¥é—¨ |

### 2. åŒºå—é“¾ç½‘ç»œå±‚ (`network/`)

| æ–‡ä»¶ | ç”¨é€” |
|------|------|
| `configtx.yaml` | é€šé“é…ç½®ï¼Œå®šä¹‰äº†ç»„ç»‡æœºæž„å’Œå…±è¯†é…ç½® |
| `crypto-config.yaml` | è¯ä¹¦é…ç½®ï¼Œç”¨äºŽç”Ÿæˆç»„ç»‡èº«ä»½ |
| `docker-compose.yaml` | å®šä¹‰äº† Peer èŠ‚ç‚¹ã€Orderer èŠ‚ç‚¹åŠ CLI å·¥å…· |

### 3. æ™ºèƒ½åˆçº¦å±‚ (`chaincode/`)

- **`chaincode.go`**: **æ ¸å¿ƒåˆçº¦é€»è¾‘**ï¼Œå®žçŽ°äº†è®¢å•çš„åˆ›å»ºã€æŽ¥å—ã€ç”Ÿäº§çŠ¶æ€æ›´æ–°ã€å–è´§å‘è´§åŠç­¾æ”¶ç¡®è®¤ã€‚

### 4. åŽç«¯åº”ç”¨å±‚ (`application/server/`)

åŸºäºŽ Gin æ¡†æž¶å®žçŽ°çš„ RESTful APIï¼š

| ç›®å½•/æ–‡ä»¶ | ç”¨é€” |
|-----------|------|
| `main.go` | ç¨‹åºå…¥å£ï¼ŒæŒ‰è§’è‰²åˆ’åˆ†ä¸º `/api/oem`, `/api/manufacturer`, `/api/carrier`, `/api/platform` è·¯ç”±ç»„ |
| `api/supply_chain.go` | ä¾›åº”é“¾å„è§’è‰²çš„ä¸šåŠ¡æŽ¥å£å¤„ç† |
| `service/supply_chain_service.go` | å°è£…äº†ä¸Žé“¾ç äº¤äº’çš„å…·ä½“é€»è¾‘ |
| `pkg/fabric/` | Fabric SDK å°è£… |

### 5. å‰ç«¯åº”ç”¨å±‚ (`application/web/`)

åŸºäºŽ Vue 3 + Vite + Ant Design Vue æž„å»ºï¼š

| ç›®å½•/æ–‡ä»¶ | ç”¨é€” |
|-----------|------|
| `src/views/` | **é¡µé¢ç»„ä»¶** |
| `src/views/OrderManagement.vue` | **å…¨è§’è‰²é€šç”¨çš„è®¢å•ç®¡ç†ä¸­å¿ƒ**ï¼Œæ ¹æ®è·¯ç”±è§’è‰²åŠ¨æ€æ˜¾ç¤ºæ“ä½œæŒ‰é’® |
| `src/api/` | åŸºäºŽ Axios å°è£…çš„åŽç«¯æŽ¥å£è¯·æ±‚ |
| `src/types/` | å®šä¹‰äº† `Order` å’Œ `Shipment` çš„ TypeScript ç±»åž‹ |

---

## ðŸ› ï¸ äºŒå¼€å»ºè®®

### 1. ä¿®æ”¹ä¸šåŠ¡å­—æ®µ

- ä¿®æ”¹ `chaincode/chaincode.go` ä¸­çš„ `Order` æˆ– `Shipment` ç»“æž„ä½“
- åœ¨ `application/server/api/supply_chain.go` ä¸­è§£æžæ–°å­—æ®µ
- åœ¨ `application/web/src/types/index.ts` ä¸­ç»´æŠ¤ç±»åž‹ä¸€è‡´æ€§

### 2. æµç¨‹æ‰©å±•

- åœ¨é“¾ç ä¸­å¢žåŠ æ–°çš„çŠ¶æ€ï¼ˆå¦‚ï¼šé€€è´§ã€è´¨æ£€ï¼‰
- åœ¨å‰ç«¯ `OrderManagement.vue` çš„ `statusSteps` ä¸­æ·»åŠ æ–°æ­¥éª¤

### 3. å¤šç»„ç»‡é€‚é…

> æœ¬é¡¹ç›®é€»è¾‘ä¸Šæ‹†åˆ†äº† 4 ä¸ªè§’è‰²ï¼Œä½†ç‰©ç†ä¸Šè¿è¡Œåœ¨ 3 ä¸ª Org ä¸Šã€‚è‹¥éœ€ç‰©ç†éš”ç¦»æ›´å¤šç»„ç»‡ï¼Œéœ€ä¿®æ”¹ `network/` é…ç½®ã€‚

---

> **æ–‡æ¡£ç‰ˆæœ¬**: v1.1 (ç»“æž„å¢žå¼ºç‰ˆ)  
> **æ›´æ–°æ—¥æœŸ**: 2024-12-26
